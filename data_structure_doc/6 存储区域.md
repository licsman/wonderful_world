针对C语言来分析程序各部分所对应的存储区域

1. 内存栈区： 存放局部变量名

   栈区（stack）— 由编译器自动分配释放 ，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈

2. 内存堆区： 存放new或者malloc出来的对象

   一般由程序员分配释放， 若程序员不释放，程序结束时可能由OS回收 。注意它与数据结构中的堆是两回事，分配方式倒是类似于链表

3. 常量区： 存放局部变量或者全局变量的值

   常量字符串就是放在这里的。 程序结束后由系统释放

4. 全局区（静态区 static）： 用于存放全局变量或者静态变量

   全局变量和静态变量的存储是放在一块的，初始化的全局变量和静态变量在一块区域（RW）， 未初始化的全局变量和未初始化的静态变量在相邻的另一块区域（ZI）。 - 程序结束后有系统释放 

5. 代码区：二进制代码。

   程序代码区—存放函数体的二进制代码



```C
int a = 0; 全局初始化区 
char *p1; 全局未初始化区 
main() 
{ 
    int b;// 栈 

    char s[] = "abc"; //"abc"在常量区，s在栈上。 

    char *p2; //栈 

    char *p3 = "123456"; //123456\0";在常量区，p3在栈上。 

    static int c =0； //全局（静态）初始化区 

    p1 = (char *)malloc(10); 

    p2 = (char *)malloc(20); 

    //分配得来得10和20字节的区域就在堆区。 

    strcpy(p1, "123456"); //123456\0放在常量区，编译器可能会将它与p3所指向的"123456"优化成一个地方。 
}
```



这张图中所示内存空间，地址由下往上增长，分别标示了 .text、.data、.bss、stack和heap的内存分部情况。 

![img](6%20%E5%AD%98%E5%82%A8%E5%8C%BA%E5%9F%9F.assets/1497264-20191228015705557-1546254805.png)



![img](6%20%E5%AD%98%E5%82%A8%E5%8C%BA%E5%9F%9F.assets/1497264-20191228015747893-1124242381.png)



- 栈区：主要用来存放局部变量, 传递参数, 存放函数的返回地址。.esp 始终指向栈顶, 栈中的数据越多, esp的值越小。
- 堆区：用于存放动态分配的对象, 当你使用 malloc和new 等进行分配时,所得到的空间就在堆中。动态分配得到的内存区域附带有分配信息, 所以你能够 free和delete它们。
- 数据区：全局，静态和常量是分配在数据区中的，数据区包括bss（未初始化数据区）和初始化数据区。

注意：

- 堆向高内存地址生长；
- 栈向低内存地址生长；
- 堆和栈相向而生，堆和栈之间有个临界点，称为stkbrk。



